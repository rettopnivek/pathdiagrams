---
title: "Tutorial"
output: rmarkdown::html_vignette
vignette: >
%\VignetteIndexEntry{my-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  ---
  
  ```{r, include = FALSE}
  knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
  )
  ```
  
  ```{r setup}
  library(pathdiagrams)
  ```
  
## Table of contents
  
1. Introduction
2. Creating a diagram and adding nodes
3. ???
4. Node aesthetics (shape, fill color, etc.)
5. Text aesthetics (size, color, etc.)
6. ???
  
## 1) Introduction
  
The *pathdiagrams* package provides an extension to base R's plotting tools for creating various types of path diagrams. The package can be used to help create diagrams displaying various structural equation model (SEM) analyses, such as factor or path analyses. The package can also be used to create CONSORT-type diagrams (subject enrollment and retention in a study).
  
## 2) Creating a diagram and adding nodes
  
Creation of a path diagram proceeds in two steps:

1. Create a blank figure using 'create_base_figure';
    + The x and y-axis boundaries for the figure are between 0 and 1.
    + By default, guidelines are provided to help with positioning.
2. Add nodes and lines/arrows via functions like 'add_nodes'.
    + Nodes can be created via the 'add_nodes' function per a text string of the format: 'Text content|x=value|y=value'.
    + Nodes are created centered at the specified x and y-axis values.
    + Multiple nodes can be created by providing a vector of text strings.
  
```{r,fig.height = 3.54, fig.width = 3.54}
# Creates a base figure with lower and upper limits from 
# 0 to 1. By default, figure is 6 x 6 inches (? x ? cm), 
# and has guidelines to aid with development and 
# positioning for the diagram.
create_base_figure( new = FALSE )

# Add a rectangle with the text 'Node-01' centered at 
# the (x,y) coordinates (0.3,0.8). Input is formatted 
# as: 'Text|x=coordinate|y=coordinate' - each element 
# is separated by the '|' symbol.
add_nodes( 'Node-01|x=.3|y=.8' )

# Add multiple nodes with text at different y-axis 
# positions.
add_nodes( c( 'Node-02|x=.3|y=.6', 'Node-03|x=.3|y=.4' ) )
```

## 3) ???

Forthcoming.

```{r,fig.height = 3.54, fig.width = 3.54}
create_base_figure( new = FALSE )

inputs <- c(
  N01 = 'Node-01|x=.3|y=.861',
  N02 = 'Node-02|x=.3|y=.339'
)
nodes <- add_nodes( inputs, output = TRUE )

size( nodes$N01 )

sep( nodes, c( 'N01', 'N02' ), 
     dimension = 'y-axis' )

sep( nodes, c( 'N01', 'N02' ), 
     dimension = 'y-axis', desired = .1 )
```

Forthcoming.

```{r,fig.height = 3.54, fig.width = 3.54}
create_base_figure( new = FALSE )

inputs <- c(
  N01 = 'Node-01|x=.3|y=.861',
  N02 = 'Node-02|x=.3|y=.639'
)
nodes <- add_nodes( inputs, output = TRUE )

```

## 4) Node aesthetics (shape, fill color, etc.)

Multiple options controlling the aesthetics of a node can be included. Options, separated by the pipe symbol '|', are added to the end of the text string with the text content and x and y-axis position. Options for nodes are in the form 'n_=' with the underscore replaced by an appropriate letter. For example, to change a node's fill color to red, the full text string would be:

'Text content|x=value|y=value|nc=red'

The following figure showcases the range of options and how the options should be specified:

```{r,fig.height = 3.54, fig.width = 3.54}
create_base_figure( guidelines = FALSE, new = FALSE )

inputs <- c(
  # Change shape to ellipse
  N01 = 'Node-01|x=.5|y=.9|ns=circle',
  # Change fill color to grey
  N02 = 'Node-02|x=.5|y=.7|nc=grey80',
  # Change border color to red
  N03 = 'Node-03|x=.5|y=.5|nb=red',
  # Change padding around text
  N03a = 'Node-03a|x=.175|y=.5|np=1.5',
  # Change padding around text
  N03b = 'Node-03b|x=.825|y=.5|nx=.23|ny=.15',
  # Change border width
  N04 = 'Node-04|x=.5|y=.3|nw=4',
  # Change border type
  N05 = 'Node-05|x=.5|y=.1|nt=3'
)
nodes <- add_nodes( inputs, output = TRUE, text.size = .85 )

text( c( .5, .5, .5, .175, .825, .5, .5 ), 
      c( .825, .625, 0.425, .375, .38, .225, .025 ),
      c( 'ns=circle', 'nc=grey80', 'nb=red', 
         'np=1.5', 'nx=.23|ny=.15', 'nw=4', 
         'nt=3' ),
      cex = .85, xpd = NA
)
```

## 5) Text aesthetics (size, color, etc.)

Forthcoming.

```{r,fig.height = 3.54, fig.width = 3.54}
create_base_figure( guidelines = FALSE, new = FALSE )

inputs <- c(
  # Change text size
  N02 = 'Text-01|x=.5|y=.9|ts=2',
  # Change text color
  N02 = 'Text-02|x=.5|y=.65|tc=red',
  # Multiple lines of text
  N03 = 'Text-03\nText-04|x=.5|y=.4',
  # Change spacing between lines
  N04 = 'Text-05\nText-06|x=.5|y=.15|th=.08'
)
nodes <- add_nodes( inputs, output = TRUE, text.size = .85 )

text( .5, c( .78, .58, .02 ),
      c( 'ts=2', 'tc=red', 'th=.08' ),
      cex = .85, xpd = NA
)
```

## 6) ???

Forthcoming.

```{r,fig.height = 3.54, fig.width = 3.54}
create_base_figure( guidelines = FALSE, new = FALSE )

inputs <- c(
  N01 = 'Node-01|x=.25|y=.25',
  N02 = 'Node-02|x=.25|y=.75',
  N03 = 'Node-03|x=.75|y=.75',
  N04 = 'Node-04|x=.75|y=.25'
)

paths <- c(
  # Arrow between Node-01 and Node-04
  'N01|right|N04|left',
  # 
  'N01|top|N02|bottom|lp=0|ll=0',
  # 
  'N02|right|N03|left|cd=<->',
  # 
  'N03|bottom|N04|top|lw=4|lc=red',
  # 
  'x,y|.25,.5|x,y|.75,.5'
)

nodes <- add_nodes( inputs, paths, output = TRUE, path.length = .1 )
```

